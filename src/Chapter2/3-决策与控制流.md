# 决策与控制流
# **第二章 决策/控制流**

“鱼，我所欲也；熊掌，亦我所欲也。二者不可得兼，舍鱼而取熊掌者也。”这句话出自《‌孟子·告子上》中的《鱼我所欲也》。在鱼和熊二者二选一之时，孟子选择了熊掌，这是孟子做出的决策。同样，我们的外卖骑手每逢用餐高峰期都会同时接到很多单，每个单子都有限制送达时间，这时候外卖小哥就需要根据自己的大脑计算时间做出决策，到底先送哪一个再送哪一个会在节省时间成本的同时节省距离成本。这就是外卖骑手的决策。

## **2.1 比较数据值**

我们所说的决策是指决定的策略或办法，是人们为各种事件出主意、做决定的一个过程‌。现在的社会不乏有很多的选择困难症“患者”，我想学习好编程语言中的决策，是“治疗”选择困难症的良药，是利于病且不苦口的良药。相比较选择困难症做选择时的艰难困苦，做决策只是计算机编程的基础，计算机做决策的操作对象是数据，数据从哪里来好说，但是如何比较数据值？如何根据比较结果修改程序的执行顺序？如何处理多个选择?这都是我们要解决的问题。

“如果交通信号灯是红灯，就停车”、“如果车速超过最大值，就减速”这两种类型的比较，一个是对象不同，但是返回的结果都是真或假其中的一个，看来看似深奥的比较无非就是真真假假而已。那么如何比较数据值呢？在编程语言中使用两个运算符集就可以比较数据值，这两个运算符集就是关系运算符（>、<、=）和相等运算符（<=、>=、!=）。需要注意的是，我们使用这些运算符比较得到的只有两个值：true和false，这两个值为布尔类型。

## **2.2 应用比较运算符**

`	`布尔类型的值在编程的返回结果中被表示为0和1，分别代表true和false。在比较运算符的应用中我们需要牢记的是，算数运算符的优先级总是高于比较运算符。 （优先级的概念我们在上一章中已经讲解，请按需复习运算符的优先级规则。）假设有两个整型变量i和j，分别赋值为10和-5，有下面所示的这些表达式： i>j; i != j;i<= j+15;这些表达式最终的计算结果都是true，需要注意的是在第三个表达式i<= j+15；中，要先计算出j+15的值，因为数运算符的优先级总是高于比较运算符。

`	`对于浮点数值的比较，当然也是一样的。但是浮点数中有一个特别的数值，那就是NaN，NaN值及不大于、小于也不等于任何其他数字，甚至也不等于另外一个NaN值。我们现在可以使用关系运算符比较任何类型的值（是不是听起来强的可怕）但是我们需要一种方式来使用比较的结果，来改变程序本来的行为，稍后我们会讲到这种方式，现在我们先学习下太空飞船运算符。

### **2.2.1 太空飞船运算符**

C++20中的太空飞船运算符实际上是根据形状来命名的，我们通常也把它叫做三向比较运算符，用<=>表示。很容易理解，在表达式a<=>b；中，就是来判断a是否小于、等于或者大于b。下面根据代码来简单的学习一下太空飞船运算符。

![](../img/Aspose.Words.0275c6d0-8912-4bc6-8629-ef1592146076.008.png)上图右侧的代码就是在C++20中引入太空飞船运算符之后进行比较的代码，可以看出明显的比左侧的C++17代码要简单很多，在C++17中需要使用if语句进行比较。对比C++20，我们删除了<format>头文件和相关的 std::format 使用，因为C++17不支持这一功能。使用 if-else 语句来判断 value 的值并根据条件输出相应的信息。每个条件的输出都是通过 cout 进行的，而不依赖于格式化字符串。足以再次看出format给我们带来的便利。

顺序流程、分支流程、循环流程

## **2.3 if语句**

![](../img/Aspose.Words.0275c6d0-8912-4bc6-8629-ef1592146076.009.png)

如果给定的条件为true，那么基本的if语句允许程序执行一个语句或语句块，如上图所示。

`	`在C++20中，if语句更新了初始化器，这意味着可以在if的范围内声明并初始化变量，这也给编程者带来了极大的便利，例如，如果我们想比较两个数的大小，有无初始化器的区别显而易见。

![](../img/Aspose.Words.0275c6d0-8912-4bc6-8629-ef1592146076.010.png)

### `	`**2.3.1 嵌套的if语句**

我们把if语句中的条件为true时执行的语句也是if语句的情况叫做嵌套的if语句，简单来说就是if语句中还有一个if语句。嵌套的if语句可以是一个，也可以是多个。在下面的代码中，我们来判断用户输入的字符是大写字母还是小写字母，就单纯的使用了嵌套的if语句。

- #include <iostream>
- int main()
- {
- `    `char inputChar;
- `    `std::cout << "请输入一个字符: ";
- `    `std::cin >> inputChar;
- `    `*// 判断输入的字符是否为字母*
- `    `if (inputChar >= 'A' && inputChar <= 'Z')
- `    `{
- `        `std::cout << inputChar << " 是一个大写字母。\n";
- `    `}
- `    `if (inputChar >= 'a' && inputChar <= 'z')
- `    `{
- `        `std::cout << inputChar << " 是一个小写字母。\n";
- `    `}
- `    `*// 如果不是字母的情况下，打印相应提示*
- `    `if (!(inputChar >= 'A' && inputChar <= 'Z') && !(inputChar >= 'a' && inputChar <= 'z'))
- `    `{
- `        `std::cout << inputChar << " 不是一个字母。\n";
- `    `}
- `    `return 0;
- }

输出示例如下所示：

![](../img/Aspose.Words.0275c6d0-8912-4bc6-8629-ef1592146076.011.png)

当然这个程序只是为了帮助你理解什么是嵌套的if语句，并没有什么实际的价值，但这不是测试字符的最好办法，我们使用标准库可以编写出独立于字符编码的程序。在下面的代码中，我们使用std::isalpha来判断输入字符是否为字母，之后我们使用std::isupper and std::islower：分别用于判断字符是否为大写字母或小写字母。，如果用户输入的字符既不是大写字母也不是小写字母，程序就会输出“不是字母”。

- #include <iostream>
- #include <cctype> // 包含字符分类功能
- int main()
- {
- `    `char inputChar;
- `    `std::cout << "请输入一个字符：";
- `    `std::cin >> inputChar;
- `    `*// 使用 std::isalpha 判断字符是否为字母*
- `    `if (std::isalpha(inputChar))
- `    `{
- `        `*// 判断大写和小写*
- `        `if (std::isupper(inputChar))
- `        `{
- `      `std::cout << inputChar << " 是一个大写字母。" << std::endl;
- `        `} else
- `        `{
- `      `std::cout << inputChar << " 是一个小写字母。" << std::endl;
- `        `}
- `    `} else
- `    `{
- `       `std::cout << inputChar << " 不是一个字母。" << std::endl;
- `    `}
- `    `return 0;
- }

运行此程序可以得到和使用嵌套的if语句的示例中一样的结果。

## **2.4 if-else语句**

我们前面讲解的if语句是在指定的条件为true时执行一个语句（块），然后程序继续往下执行。接下来我们学习使用if-else语句，它能够让程序在结果为true时执行某个语句（块），在结果为false时执行另一个语句（块）。

`	`今天中午出门你遇到了朋友，你问他“How are you feeling today?”如果他回答你"hungry"，那么你就说："How about a hearty sandwich?"如果他说“bored”，你就回答："Try some popcorn for a fun snack!"。下面是实现的代码：

- #include <iostream>
- #include <string>
- int main()
- {
- `    `std::string mood;
- `    `std::cout << "How are you feeling today? (hungry, bored): ";
- `    `std::cin >> mood;
- `    `if (mood == "hungry")
- `    `{
- `        `std::cout << "How about a hearty sandwich?" << std::endl;
- `    `}
- `    `else
- `    `{
- `        `std::cout << "Try some popcorn for a fun snack!" << std::endl;
- `    `}
- `    `return 0;
- }

代码的执行如下所示：

![](../img/Aspose.Words.0275c6d0-8912-4bc6-8629-ef1592146076.012.png)

![](../img/Aspose.Words.0275c6d0-8912-4bc6-8629-ef1592146076.013.png)

### `	`**2.4.1 嵌套的if-else语句**

程序语句的嵌套具有极大的灵活性。前面我们提到了在if语句中嵌套if语句，显然也可以在if语句中嵌套if-else语句，在if-else语句中嵌套if语句，在if-else语句中嵌套其他的if-else语句。

`	`在使用嵌套的if-else时，我们可以选择使用或者不使用花括号，例如：

- `    `if(coffee == 'y')
- `        `if(donuts == 'y')
- `      `std::cout << "We have coffee and donuts." << std::endl;
- `        `else
- `      `std::cout << "We have coffee, but no donuts." << std::endl;

上面的例子中，对donuts的测试仅仅在coffee测试结果为true时才进行，因此在每种情况下消息都会反应正确的情形。else属于donuts测试中的if语句。但是这样很容易引起混淆，如果代码的缩进格式存在错误，就会出现错误的结论。

- `    `if(coffee == 'y')
- `        `if(donuts == 'y')
- `      `std::cout << "We have coffee and donuts." << std::endl;
- `    `else
- `      `std::cout << "We have coffee, but no donuts." << std::endl;

上面代码的缩进格式会让人错误的认为是if语句嵌套在if-else语句中，但实际上并非如此。if结构越大越复杂，就越需要记住下面的规则，以便弄清楚哪个if拥有哪个else。

注意：else总是属于前面最接近的那个if（只要另外一个else还不属于这个if）。潜在造成的混淆成为else悬挂问题。所以我们要使用花括号来使代码更清晰。

- `        `if(coffee == 'y')
- `        `{
- `            `if(donuts == 'y')
- `            `{
- `      `std::cout << "We have coffee and donuts." << std::endl;
- `            `}
- `            `else
- `            `{
- `      `std::cout << "We have coffee, but no donuts." << std::endl;
- `            `}
- `        `}

这段代码看起来已经很复杂了，不敢想象如果说在if-else语句中嵌套一个if-else语句会是多么混乱，在实际运用中，处理这种逻辑会有更好的方式，毕竟足够多的嵌套if语句放到一起肯定会出错，后面我们会简化这个过程。

## **2.5逻辑运算符**

我们在前面说到的在有两个或者更多个相关条件的地方使用if语句非常复杂。我们编写的程序需要面向实际应用，上面这些简短的代码显然是微不足道，我们需要有更多更复杂的条件来检索，比如，搜索年龄在21岁到35岁之间、拥有学士或硕士学历、未婚的男性。定义这样一个测试将涉及许多if语句。很显然现在我们需要更简洁且高效的解决方案。于是我们就想到了逻辑运算符，它可以把一系列比较组合到一个表达式中，这样，无论条件多么复杂，都只需要一个if，而且逻辑运算符只有三个，分别是逻辑与（&&）、逻辑或（||）、逻辑非（！）。

### `	`**2.5.1逻辑与、或、非运算符**

在C++中，逻辑运算符用于操作布尔类型的值（true和false），他们主要有下面三种。

![](../img/Aspose.Words.0275c6d0-8912-4bc6-8629-ef1592146076.014.png)

`	`现在你正在设计一个游戏，玩家需要满足一定的条件才能进入一个场景或完成任务，那么我们就可以使用逻辑运算符来判断玩家是否具备进入条件。

- #include <iostream>
- using namespace std;
- int main()
- {
- `    `*// 假设玩家有两个属性：生命值和金币数量*
- `    `int health = 80;  *// 生命值*
- `    `int gold = 50;    *// 金币数量*
- `    `*// 条件：玩家需要至少有60的生命值和40的金币才能进入洞穴*
- `    `if (health >= 60 && gold >= 40)
- `    `{
- `        `cout << "你可以进入洞穴！" << endl;
- `    `} else
- `    `{
- `        `cout << "你不够强大，无法进入！" << endl;
- `    `}
- `    `*// 假设现在玩家找到了一个药水，使用后生命值增加到100*
- `    `health = 100;
- `    `*// 使用逻辑或判断如果玩家的生命值为0或者金币不够*
- `    `if (health == 0 || gold < 40)
- `    `{
- `        `cout << "你无法继续冒险！" << endl;
- `    `} else
- `    `{
- `        `cout << "继续冒险的路上，你充满生机！" << endl;
- `    `}
- `    `*// 使用逻辑非判断玩家的状态*
- `    `if (!(health <= 0))
- `    `{
- `        `cout << "你还活着，继续探险吧！" << endl;
- `    `} else
- `    `{
- `        `cout << "你已经失败了，游戏结束！" << endl;
- `    `}
- `    `return 0;
- }

在上面的代码中，我们给玩家设置了两个变量，分别是生命值和金币数量，要想进入洞穴玩家需要至少有60的生命值和40的金币，当你不满足条件时会给你提示信息告知无法进入，但是玩家可以获得一种神奇药水，使用后生命值能够增加到100，之后使用逻辑或判断如果玩家的生命值为0或者金币不够，若玩家可以继续游戏，那么久输出提示信息“继续冒险的路上，你充满生机”。最后我们使用逻辑非运算符判断玩家的状态，通过判断生命值是否小于等于0来判断你是否还可以继续游戏。

注意：
逻辑运算符

1. 逻辑与（AND） &&:

只有当两个子表达式都为真时，结果才为真。

真（true） 和 假（false） 的情况如下所示：

true  &&  true   => true

true  &&  false  => false

false &&  true   => false

false &&  false  => false

1. 逻辑或（OR） ||:

只要有一个子表达式为真，结果就为真。

看看情况：

true  ||  true   => true

true  ||  false  => true

false ||  true   => true

false ||  false  => false

1. 逻辑非（NOT） !:

用于取反，如果是真就变为假，如果是假的就变为真。

示例：

!true  => false

!false => true

## **2.6 条件运算符**

现在有部分青少年沉迷游戏，游戏厂商A想要编写一段简单的代码来限制未成年用户的游戏时间为每天1小时，如果年龄满足18周岁以上，允许不限制时间，否则每天只能玩一小时。下面我们就要使用到条件运算符来解决这一个简单的问题。

条件运算符也成为三元运算符 ，之前我们说到过二元运算符、一元运算符等等，需要注意的是，条件运算符是唯一的一个三元运算符。

- #include <iostream>
- using namespace std;
- int main()
- {
- `    `int age;
- `    `cout << "请输入你的年龄: ";
- `    `cin >> age;
- `    `*// 使用条件运算符检查年龄*
- `    `string access = (age >= 18) ? "你可以观看这个电影。" : "抱歉，你必须年满18岁才能观看。";
- `    `*// 输出结果*
- `    `cout << access << endl;
- `    `return 0;
- }

在上面的代码中，我们首先提示用户输入年龄。使用条件运算符 (age >= 18) ? "你可以继续玩游戏。" : "抱歉，你的游戏时长已用完。"; 来检查用户的年龄。如果用户的年龄大于或等于18岁，access 将被赋值为 "你可以继续玩游戏。"，否则将被赋值为 "抱歉，你的游戏时长已用完。"。最后，我们输出相应的结果即可。

## **2.7 switch语句**

前面我们讲到了if语句，和它相比switch语句在处理多个分支的时候更加清晰和简洁，程序可以根据表达式的值选择执行相应的代码块。下面我们使用switch语句实现一个简单的计算器，它允许用户选择不同的运算（加、减、乘、除）。

- #include <iostream>
- using namespace std;
- int main()
- {
- `    `char operation;
- `    `double num1, num2;
- `    `cout << "请输入两个数字: ";
- `    `cin >> num1 >> num2;
- `    `cout << "选择操作 (+, -, \*, /): ";
- `    `cin >> operation;
- `    `switch (operation)
- `    `{
- `        `case '+':
- `            `cout << "结果: " << (num1 + num2) << endl;
- `            `break;
- `        `case '-':
- `            `cout << "结果: " << (num1 - num2) << endl;
- `            `break;
- `        `case '\*':
- `            `cout << "结果: " << (num1 \* num2) << endl;
- `            `break;
- `        `case '/':
- `            `if (num2 != 0)
- `            `{
- `                `cout << "结果: " << (num1 / num2) << endl;
- `            `} else
- `            `{
- `                `cout << "错误: 除数不能为零！" << endl;
- `            `}
- `            `break;
- `        `default:
- `            `cout << "无效的操作！" << endl;
- `    `}
- `    `return 0;
- }

1. 代码解释：
   **用户输入**: 程序首先要求用户输入两个数字。
   
   **选择操作**: 然后，用户选择运算符（加、减、乘、除）。
   
   **switch 语句**: 根据用户的选择，使用 switch 执行相应的操作：
   
   1. 如果选择 +，则执行加法并输出结果。
   2. 如果选择 -，则执行减法并输出结果。
   3. 如果选择 \*，则执行乘法并输出结果。
   4. 如果选择 /，程序会检查是否除以零，避免错误。

**default**: 如果输入的不符合任何操作，程序会输出无效的操作提示。

## **2.8 本章小结**

- 可以使用比较运算符比较两个值，得到一个bool类型的值，它可以是tue 或 false。
- 可以把布尔值强制转换为整数类型--将 tnue 强制转换为1，将 false 强制转换为0。
- 可以把数值强制转换为bool类型--将0强制转换为false，将非0值强制转换为true。在需要布尔值的地方使用数值，例如在汇条件中，编译器就会自动把数值隐式转换为bool类型。
- if 语句可以根据条件表达式的值执行一个语句或语句块。如果条件是 tue，就执行语句或语句块。如果条件是flse，就不执行。
- 如果条件是 true，if-else语句就执行一个语句或语句块。如果条件为 false，就执行另一个语句或语句块。
- if和 ielse 语句可以嵌套。
- 逻辑运算符&&、|| 和!用于连接形成更复杂的逻辑表达式。这些运算符的参数必须是布尔值，或是可以转换为布尔值的值(如整型值)。
- 条件运算符?:根据布尔表达式的值，选择两个值中的一个。
- switch 语句可以根据整型或枚举类型表达式的值，从一组固定的选项中选择一个。

